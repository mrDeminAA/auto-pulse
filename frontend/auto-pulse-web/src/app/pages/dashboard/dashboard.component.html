<div class="dashboard">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-left">
      <svg class="logo-icon" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M24 4L4 14V34L24 44L44 34V14L24 4Z" stroke="currentColor" stroke-width="2" fill="none"/>
        <circle cx="24" cy="24" r="8" fill="currentColor"/>
      </svg>
      <h1 class="logo-text">AutoPulse</h1>
    </div>
    <div class="header-right">
      <span class="user-name">{{ userName() }}</span>
      <button class="logout-button" (click)="authStorePublic.logout()" title="–í—ã–π—Ç–∏">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Main content -->
  <main class="dashboard-content">
    <div class="content-wrapper">
      <!-- Welcome section -->
      <section class="welcome-section">
        <h2 class="welcome-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user()?.name || user()?.email }}! üëã</h2>
        <p class="welcome-subtitle">
          –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        </p>
      </section>

      <!-- Stats cards -->
      <section class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon stat-icon_cars">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"/>
              <circle cx="6.5" cy="16.5" r="2.5"/>
              <circle cx="16.5" cy="16.5" r="2.5"/>
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-value">{{ stats.totalCars }}</span>
            <span class="stat-label">–ê–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–∞–π–¥–µ–Ω–æ</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon_new">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-value">{{ stats.newToday }}</span>
            <span class="stat-label">–ù–æ–≤—ã—Ö –∑–∞ 24—á</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon_favorites">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-value">{{ stats.favorites }}</span>
            <span class="stat-label">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon stat-icon_alerts">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
            </svg>
          </div>
          <div class="stat-info">
            <span class="stat-value">{{ stats.alerts }}</span>
            <span class="stat-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</span>
          </div>
        </div>
      </section>

      <!-- Search status section -->
      <section class="search-section">
        <div class="section-header">
          <h3 class="section-title">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h3>
          <a routerLink="/search" class="button button-primary">
            @if (!userSearch) {
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              –°–æ–∑–¥–∞—Ç—å –ø–æ–∏—Å–∫
            } @else {
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
              </svg>
              –ò–∑–º–µ–Ω–∏—Ç—å
            }
          </a>
        </div>

        @if (loading) {
          <div class="loading-card">
            <div class="spinner"></div>
            <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
          </div>
        } @else if (!userSearch) {
          <div class="empty-state">
            <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            <h4 class="empty-title">–ü–æ–∏—Å–∫ –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</h4>
            <p class="empty-text">
              –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É, –º–æ–¥–µ–ª—å –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
            </p>
            <a routerLink="/search" class="button button-primary">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–∏—Å–∫</a>
          </div>
        } @else {
          <div class="search-status-card">
            <div class="search-header">
              <div class="search-info">
                <span class="search-brand">{{ userSearch?.brandName }} {{ userSearch?.modelName }}</span>
                <span class="search-params">
                  {{ userSearch?.yearFrom }}‚Äì{{ userSearch?.yearTo }},
                  {{ userSearch?.maxPrice || '–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è' }} ‚ÇΩ
                </span>
              </div>
              <span class="status-badge status-badge_{{ userSearch?.status?.toLowerCase() }}">
                {{ getStatusLabel(userSearch?.status || '') }}
              </span>
            </div>
            <div class="search-progress">
              <div class="progress-bar">
                <div class="progress-fill" [style.width]="searchProgress"></div>
              </div>
              <span class="progress-text">–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...</span>
            </div>
          </div>
        }
      </section>

      <!-- Recent cars section (–∑–∞–≥–æ—Ç–æ–≤–∫–∞) -->
      <section class="recent-section">
        <div class="section-header">
          <h3 class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h3>
          <a routerLink="/cars" class="button button-secondary">–í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</a>
        </div>
        <div class="empty-state empty-state_small">
          <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"/>
            <circle cx="6.5" cy="16.5" r="2.5"/>
            <circle cx="16.5" cy="16.5" r="2.5"/>
          </svg>
          <p class="empty-text">–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</p>
        </div>
      </section>
    </div>
  </main>
</div>
